<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>ğŸ§ª Simulador SBML</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>
<body>
  <h1>ğŸ§ª Simulador SBML</h1>
  <input type="file" id="fileInput"><br><br>
  <button onclick="inspectModel()">ğŸ” Inspeccionar modelo</button>
  <button onclick="simulateModel()">â–¶ï¸ Simular</button>

  <h3>ParÃ¡metros detectados:</h3>
  <pre id="params"></pre>

  <div id="plot"></div>

<script>
const API = "https://backend-2e5l.onrender.com"; // Cambiar despuÃ©s de desplegar backend

async function inspectModel() {
  const file = document.getElementById("fileInput").files[0];
  let formData = new FormData();
  formData.append("file", file);

  let res = await fetch(API + "/inspect", { method: "POST", body: formData });
  let data = await res.json();
  document.getElementById("params").innerText = JSON.stringify(data, null, 2);
}

async function simulateModel() {
  const file = document.getElementById("fileInput").files[0];
  let formData = new FormData();
  formData.append("file", file);

  let res = await fetch(API + "/simulate?t_start=0&t_end=50&n_points=200", {
    method: "POST",
    body: formData
  });
  let data = await res.json();

  let traces = [];
  const time = data.data.map(row => row[0]);
  for (let j = 1; j < data.colnames.length; j++) {
    let values = data.data.map(row => row[j]);
    traces.push({ x: time, y: values, mode: "lines", name: data.colnames[j] });
  }
  Plotly.newPlot("plot", traces, { title: "SimulaciÃ³n de especies" });
}
</script>
</body>
</html>
